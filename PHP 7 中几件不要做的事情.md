> 不要使用 mysql_ 类函数

终于，你不用再看到建议不要使用 mysql_ 函数的提示了。因为 PHP 7 从核心上完全移除了它们，这意味着请你移步至更好的 mysqli_ 类函数，或者更灵活的 PDO 层。



> 不要写无用的代码

这看上去是个无脑建议，但是随着 PHP7 速度的提升掩盖了一些问题使它显得日趋重要。不要仅仅因切到 PHP7 让网站速度变得快点，你就沾沾自喜了。

想理解速度的重要性和如何做的更好，去看看我们这篇文章 初学者加速优化指南。

作为开发者，应该确保按需加载脚本，可能时再组合，编写高效的数据库查询语句，如果可能的话 使用缓存 等等。



> 不要在文件末尾使用 PHP 闭合标签

如果你随便看看，就会发现大部分 WordPress 核心代码文件结尾都省略了 PHP 闭合标签。事实上，Zend 框架尤为明显地 禁止了闭合标签。它并非 PHP 所必须，在文件结尾处省略它，可确保结尾无额外空白。



> 如非必须不要引用传参

我个人非常不喜欢引用传参。我当然知道在某些场合下它很有用，但是多数场合下，它会使得代码难以理解，难以遵循，难以预测结果。

人们认为引用可以使它们的代码更快，不过正如 可敬的 PHP 程序员 的这篇文章所指出的，事实并非如此。

PHP 内置的 shuffle() 或者 sort() 函数，就是糟糕的引用传参案例。 它修改了原数组而不是返回一个打乱的或者排好序的数组，这是完全违背了我们意愿的。



> 不要在循环里使用查询

在循环中使用数据库查询时最糟糕的。他会给系统带来不必要的压力，并且很有可能，你可以在循环外使用查询而更快的得到相同的结果。当我碰到必须这样用的场景时，我通常会通过分成两个查询来构造一个数组的方式来解决。然后循环数组而无需循环查询。

由于 WordPress 的运行方式，这样做可能会有些例外。 get_post_meta() 将从数据库获取一个元数据，如果您正在循环访问特定文章的元数据，则可以在循环中使用它。这是因为当你第一次使用它的时候，WordPress 实际上取得了所有的元数据并缓存了起来。 之后的调用实际上是调用缓存数据而不是调用数据库。

解决这些问题的最好办法是阅读函数文档并且使用一些类似 查询监听器 的东西。



> 不要在 SQL 查询中使用 *

好吧，这更像是一个 MySQL 的问题，但我们更倾向于在代码中编写 SQL 语句，所以我说这是个公平的游戏。不管什么情况下，如果你能避免使用通配符，那就不要使用，尤其是当你的数据库有很多字段的时候。

明确指定你需要的字段，并且只检索这些字段。这有助于节省内存，保护数据，并且能让事情变得更加清晰明白。

在 SQL 方面，尽可能的了解你可用的函数并测试速度。 当计算平均数，求和以及计算相似的数字的时候，使用 SQL 内置函数而不是 PHP 的函数。 如果你不确定一个查询的速度快慢，测试一下它并和其他做法进行比较，选出最好的那一种。



> 不要信任用户的输入

信任用户输入并不明智。对于用户输入，总是需要过滤，杀毒，转义，校验以及使用回退。 用户输入存在三个问题：我们开发者不可能考虑到所有可能性，经常出错，存心的恶意输入。

一个经过深思熟虑的系统可以防止所有的这些问题。 在使用数据库时，确保使用内置的函数，如 filter_var()，来检查合法性，进行转义，和其他能做的事。